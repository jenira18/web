<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>การใช้บริการรถโดยสาร มรพส.</title>
</head>
<body>
    <image src="รูปปกเว็บ.png" Width="110%" 
    
    <html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f0f0f0; 
        }
        .container {
            width: 100%;
            margin: 0 auto;
            padding: 30px;
            background-color: #fff; 
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        button {
            padding: 10px 20px;
            background-color: #4CAF50; /* สีเขียว */
            color: white; 
            border: none;
            cursor: pointer;
        }
        button:hover {
            background-color: #45a049; /* สีเขียวเข้มเมื่อชี้ */
        }
        </style> 
      <!DOCTYPE html>
      <html lang="th">
      <head>
          <meta charset="UTF-8">
          <meta name="viewport" content="width=device-width, initial-scale=1.0">
          <title>ระบบ QR Code ขึ้นรถ</title>
          <style>
              body {
                  font-family: Arial, sans-serif;
                  margin: 0;
                  padding: 20px;
                  background-color: #f0f0f0;
              }
              .container {
                  width: 100%;
                  margin: 0 auto;
                  padding: 30px;
                  background-color: #fff;
                  box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
              }
              h1 {
                  text-align: center;
              }
              #history {
                  margin-top: 20px;
              }
              #datetime {
                  text-align: right;
                  margin-bottom: 20px;
              }
              button {
                  padding: 10px 20px;
                  background-color: #4CAF50;
                  color: white;
                  border: none;
                  cursor: pointer;
              }
              button:hover {
                  background-color: #45a049;
              }
              .history-section {
                  margin-top: 20px;
              }
              .history-section h4 {
                  margin-bottom: 5px;
              }
              .history-section ul {
                  list-style-type: none;
                  padding: 0;
              }
              .history-section li {
                  background-color: #e0e0e0;
                  padding: 5px;
                  margin-bottom: 5px;
              }
          </style>
      </head>
      <body>
          <h1>ระบบ QR Code ขึ้นรถ</h1>
      
          <!-- แสดงวันและเวลา -->
          <div id="datetime"></div>
      
          <h3 id="availableSeats">จำนวนที่นั่งที่ว่าง: 8 ที่นั่ง</h3>
      
          <!-- ช่องสำหรับประวัติการเช็คอิน -->
          <div id="checkInHistorySection" class="history-section">
              <h4>ประวัติการเช็คอิน:</h4>
              <ul id="checkInHistory"></ul>
          </div>
      
          <!-- ช่องสำหรับประวัติการลงจากรถ -->
          <div id="checkOutHistorySection" class="history-section">
              <h4>ประวัติการลงจากรถ:</h4>
              <ul id="checkOutHistory"></ul>
          </div>
      
          <!-- ปุ่มกดลงจากรถ -->
          <button id="checkOutButton">ลงจากรถ</button>
      
          <script>
              let maxSeats = 8;
      
              // ตรวจสอบว่า LocalStorage มีจำนวนที่นั่งหรือไม่ ถ้าไม่ให้เริ่มต้นที่ 8
              if (!localStorage.getItem('availableSeats')) {
                  localStorage.setItem('availableSeats', maxSeats);
              }
      
              // ตรวจสอบว่า LocalStorage มีประวัติการเช็คอินและเช็คเอาท์หรือไม่ ถ้าไม่ให้เป็น array ว่าง
              if (!localStorage.getItem('checkInHistory')) {
                  localStorage.setItem('checkInHistory', JSON.stringify([]));
              }
              if (!localStorage.getItem('checkOutHistory')) {
                  localStorage.setItem('checkOutHistory', JSON.stringify([]));
              }
      
              // ตรวจสอบว่าผู้ใช้เช็คเอาท์แล้วหรือไม่
              if (!localStorage.getItem('hasCheckedOut')) {
                  localStorage.setItem('hasCheckedOut', 'false');
              }
      
              // อัปเดตจำนวนที่นั่งว่างและประวัติการเช็คอิน/เช็คเอาท์
              const availableSeatsElement = document.getElementById('availableSeats');
              const checkInHistory = document.getElementById('checkInHistory');
              const checkOutHistory = document.getElementById('checkOutHistory');
      
              // ฟังก์ชันแสดงจำนวนที่นั่งที่ว่าง
              function updateAvailableSeats() {
                  let currentSeats = localStorage.getItem('availableSeats');
                  availableSeatsElement.innerText = `จำนวนที่นั่งที่ว่าง: ${currentSeats} ที่นั่ง`;
              }
      
              // ฟังก์ชันแสดงประวัติการเช็คอิน
              function updateCheckInHistory() {
                  const history = JSON.parse(localStorage.getItem('checkInHistory'));
                  history.forEach(entry => {
                      checkInHistory.innerHTML += `<li>${entry.action} เวลา: ${entry.timestamp}</li>`;
                  });
              }
      
              // ฟังก์ชันแสดงประวัติการเช็คเอาท์
              function updateCheckOutHistory() {
                  const history = JSON.parse(localStorage.getItem('checkOutHistory'));
                  history.forEach(entry => {
                      checkOutHistory.innerHTML += `<li>${entry.action} เวลา: ${entry.timestamp}</li>`;
                  });
              }
      
              // ฟังก์ชันแสดงวันและเวลาปัจจุบัน
              function updateDateTime() {
                  const now = new Date();
                  const formattedDateTime = now.toLocaleString('th-TH', { timeZone: 'Asia/Bangkok' });
                  document.getElementById('datetime').innerText = `วันที่และเวลา: ${formattedDateTime}`;
              }
      
              // เมื่อหน้าโหลดแสดงจำนวนที่นั่งที่เหลือ ประวัติ และวันที่
              window.onload = function() {
                  updateAvailableSeats();
                  updateCheckInHistory();
                  updateCheckOutHistory();
                  updateDateTime();
                  setInterval(updateDateTime, 1000);  // อัปเดตเวลาทุกๆ วินาที
      
                  // เช็คอินเมื่อเปิดหน้าเว็บ (การสแกน QR)
                  checkIn();
              };
      
              // ฟังก์ชันเช็คอิน (ลดจำนวนที่นั่ง 1)
              function checkIn() {
                  let currentSeats = parseInt(localStorage.getItem('availableSeats'));
                  if (currentSeats > 0) {
                      localStorage.setItem('availableSeats', currentSeats - 1);
                      updateAvailableSeats();
                      addCheckInHistory("ขึ้นรถโดยสาร");
                  } else {
                      alert('ที่นั่งเต็มแล้ว');
                  }
              }
      
              // ฟังก์ชันเช็คเอาท์ (เพิ่มจำนวนที่นั่ง 1)
              function checkOut() {
                  let hasCheckedOut = localStorage.getItem('hasCheckedOut');
                  let currentSeats = parseInt(localStorage.getItem('availableSeats'));
      
                  if (hasCheckedOut === 'false' && currentSeats < maxSeats) {
                      localStorage.setItem('availableSeats', currentSeats + 1);
                      localStorage.setItem('hasCheckedOut', 'true');
                      addCheckOutHistory("ลงจากรถ");
                      updateAvailableSeats();
                  } else if (hasCheckedOut === 'true') {
                      alert('คุณได้ลงจากรถแล้ว ไม่สามารถลงได้อีก');
                  }
              }
      
              // ฟังก์ชันเพิ่มประวัติการเช็คอิน (โดยไม่ลบประวัติเดิม)
              function addCheckInHistory(action) {
                  const now = new Date();
                  const timestamp = now.toLocaleString('th-TH', { timeZone: 'Asia/Bangkok' });
                  let history = JSON.parse(localStorage.getItem('checkInHistory'));
                  history.push({ action, timestamp });
                  localStorage.setItem('checkInHistory', JSON.stringify(history));
                  checkInHistory.innerHTML += `<li>${action} เวลา: ${timestamp}</li>`;  // เพิ่มรายการเช็คอินใหม่
              }
      
              // ฟังก์ชันเพิ่มประวัติการเช็คเอาท์ (โดยไม่ลบประวัติเดิม)
              function addCheckOutHistory(action) {
                  const now = new Date();
                  const timestamp = now.toLocaleString('th-TH', { timeZone: 'Asia/Bangkok' });
                  let history = JSON.parse(localStorage.getItem('checkOutHistory'));
                  history.push({ action, timestamp });
                  localStorage.setItem('checkOutHistory', JSON.stringify(history));
                  checkOutHistory.innerHTML += `<li>${action} เวลา: ${timestamp}</li>`;  // เพิ่มรายการเช็คเอาท์ใหม่
              }
      
              // ปุ่มกดลงจากรถ
              document.getElementById('checkOutButton').addEventListener('click', checkOut);
      
          </script>
      </body>
      </html>
      