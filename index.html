<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>การใช้บริการรถโดยสาร มรพส.</title>
</head>
<body>
    <image src="รูปปกเว็บ.png" Width="110%" 
    
    <html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f0f0f0; 
        }
        .container {
            width: 100%;
            margin: 0 auto;
            padding: 30px;
            background-color: #fff; 
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        button {
            padding: 10px 20px;
            background-color: #4CAF50; /* สีเขียว */
            color: white; 
            border: none;
            cursor: pointer;
        }
        button:hover {
            background-color: #45a049; /* สีเขียวเข้มเมื่อชี้ */
        }
        </style> 
     <!DOCTYPE html>
     <html lang="th">
     <head>
         <meta charset="UTF-8">
         <meta name="viewport" content="width=device-width, initial-scale=1.0">
         <title>เช็คอินรถโดยสาร</title>
         <style>
             body {
                 font-family: Arial, sans-serif;
                 margin: 0;
                 padding: 20px;
                 background-color: #f0f0f0;
             }
             .container {
                 width: 100%;
                 margin: 0 auto;
                 padding: 30px;
                 background-color: #fff;
                 box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
             }
         </style>
     </head>
     <body>
         <div class="container">
             <h3 id="availableSeats">จำนวนที่นั่งว่าง: 8 ที่นั่ง</h3>
             <ul id="checkInHistory"></ul>
             
             <div id="reader" style="width: 600px;"></div>
         </div>
         
         <script src="https://unpkg.com/html5-qrcode/minified/html5-qrcode.min.js"></script>
         <script>
             // ฟังก์ชันเช็คอินที่ถูกเรียกจากโทรศัพท์เมื่อมีการสแกน QR code
             function checkIn(studentId) {
                 fetch('https://your-api-endpoint/checkin', {
                     method: 'POST',
                     headers: {
                         'Content-Type': 'application/json'
                     },
                     body: JSON.stringify({ studentId: studentId })
                 })
                 .then(response => response.json())
                 .then(data => {
                     console.log('เช็คอินสำเร็จ:', data);
                     // อัพเดตจำนวนที่นั่งว่างใน UI
                     updateAvailableSeats(data.availableSeats);
                     // อัพเดตประวัติการเช็คอิน
                     updateCheckInHistory(data.checkInTime);
                 })
                 .catch((error) => {
                     console.error('เกิดข้อผิดพลาด:', error);
                 });
             }
     
             // ฟังก์ชันที่ถูกเรียกเมื่อ QR code ถูกสแกน
             function onScanSuccess(decodedText, decodedResult) {
                 console.log(`QR code ถูกสแกน: ${decodedText}`);
                 
                 const studentId = decodedText; // สมมติว่า decodedText คือ studentId
                 checkIn(studentId); // เรียกใช้ฟังก์ชัน checkIn เมื่อสแกน QR code สำเร็จ
             }
     
             // ฟังก์ชันอัพเดตจำนวนที่นั่งว่าง
             function updateAvailableSeats(availableSeats) {
                 document.getElementById('availableSeats').innerText = `จำนวนที่นั่งว่าง: ${availableSeats}`;
             }
     
             // ฟังก์ชันอัพเดตประวัติการเช็คอิน
             function updateCheckInHistory(checkInTime) {
                 const historyElement = document.getElementById('checkInHistory');
                 const listItem = document.createElement('li');
                 listItem.textContent = `ขึ้นรถ: ${checkInTime}`;
                 historyElement.appendChild(listItem);
             }
     
             // เริ่มต้นการสแกน QR code
             function startScanner() {
                 const html5QrCode = new Html5Qrcode("reader");
     
                 // เริ่มต้นการสแกน QR code
                 html5QrCode.start(
                     { facingMode: "environment" }, // ใช้กล้องด้านหลัง
                     {
                         fps: 10, // เฟรมเรท
                         qrbox: 250 // ขนาดของกรอบ QR code
                     },
                     onScanSuccess, // ฟังก์ชันที่ถูกเรียกเมื่อสแกน QR code สำเร็จ
                     (errorMessage) => {
                         // ฟังก์ชันนี้จะถูกเรียกเมื่อเกิดข้อผิดพลาดในการสแกน
                         console.log(`เกิดข้อผิดพลาด: ${errorMessage}`);
                     }
                 ).catch(err => {
                     console.error(`ไม่สามารถเริ่มต้นการสแกน: ${err}`);
                 });
             }
       
             // เรียกใช้ฟังก์ชันเริ่มต้นเมื่อโหลดหน้า
             window.onload = startScanner;
         </script>
     </body>
     